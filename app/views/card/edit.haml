- card_on_file = !!@stripe
- title = "#{card_on_file ? 'Update' : 'Add'} Card"
- title title

- content_for :header do
  %meta{ name: "stripe-key", content: STRIPE_PUBLIC_KEY }

- content_for :footer do
  :javascript
    var requireConfirmation = #{!!@invoice ? 'true' : 'false'};
  = javascript_include_tag "https://js.stripe.com/v1/"
  = javascript_include_tag "card"

- if card_on_file
  %h1 Card on File
  = render 'current', stripe: @stripe

= render 'shared/subscriptions_submenu', current: 'card'

= form_tag card_url, method: :put, id: 'card_form' do
  = hidden_field_tag 'stripe_card_token'
  %fieldset
    %h1= title
    %ol= render 'card/fields'
    %p.submit
      = submit_tag 'Submit', class: 'button'