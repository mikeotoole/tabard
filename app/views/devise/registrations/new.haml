- title 'Sign up'

#body
  %h1 Sign up for Tabard&trade;

  - resource.build_user_profile unless resource.user_profile
  = simple_form_for(resource, as: resource_name, url: registration_url(resource_name, subdomain: "secure", protocol: (Rails.env.development? ? "http://" : "https://"))) do |f|
    %fieldset
      %ol
        -if User::BETA_CODE_REQUIRED
          = f.input :beta_code
        = f.simple_fields_for :user_profile do |uf|
          = uf.input :display_name, label: "Player name", required: false, hint: "You can change this later. #{UserProfile::MAX_NAME_LENGTH} characters max."
        = f.input :email, as: :email
        = f.input :email_confirmation, as: :email
        %li{ class: "date select #{f.object.errors[:date_of_birth].any? ? 'field_with_errors' : ''}"}
          %label Birthday
          .month= f.input :birth_month, as: :radio, label: false, collection: (1..12).collect{|m| m = [Date::MONTHNAMES[m], m]}, wrapper: false
          .day= f.input :birth_day, as: :radio, label: false, collection: 1..31, wrapper: false
          .year= f.input :birth_year, as: :radio, label: false, collection: Time.zone.now.year.downto(Time.zone.now.year-100), wrapper: false
          - if f.object.errors[:date_of_birth].any?
            %mark.error= f.object.errors[:date_of_birth].first
      %p.help{ href: 'javascript:;', onclick: '$.alert({title:"Your Birthday",body:"Tabard is a service exclusively for players 13 years of age and older. We need your birthday to make sure that you are eligable for an account."})' }
        Why is my birthday required?
        = f.input :password, input_html: defined?(params[:user][:remember_password]) ? { value: params[:user][:remember_password] } : {}
        - unless !!cookies[:timezone]
          = f.input :time_zone, required: false, collection: timezone_collection_hash, as: :radio, wrapper_html: { class: 'select' }
      - if !!cookies[:timezone]
        = f.input :time_zone, as: :hidden, input_html: { value: cookies[:timezone].to_s }
      %p.terms
        By clicking "Sign up", you agree to our
        = link_to 'Terms', top_level_terms_of_service_url
        and that you have read our
        = (link_to 'Privacy Policy', top_level_privacy_policy_url) + '.'
      %p
        %button{ type: 'submit' } Sign up
  = render "devise/shared/links"
