= simple_form_for [:management, @role] do |f|

  - if !@role.is_system_role?
    %fieldset
      %ol
        = f.input :name
        = f.input :description, :as => 'text', :input_html => { :rows => 3 }
  
  - if @role.id #HACK
      
    %h2 Permissions
    
    %table
      - if @role.permissions.size > 0
        %thead
          %tr
            %th.actions
            %th.permresource Resource
            %th View
            %th Edit
            %th Add
            %th Delete
        %tbody
          - @role.permissions.each do |permission|
            = f.simple_fields_for :permissions, permission do |p|
              = render :partial => 'subdomains/management/permissions/form_fields', :locals => { :f => f, :p => p, :permission => permission }
      -else
        %tbody
          %tr
            %td.empty{ :colspan => 6 } This role has no permissions.
      %tfoot
        %tr
          %td{ :colspan => 6 }
            = link_to "Add Permission", new_management_role_permission_path(@role, :format => :js), :remote => true, :class => 'button icon add'
    
    - if @role.can_update_users
      %h2 Users
      - if @users.size > 0
        %fieldset#usercheckboxes
          %ol
            - for user in @users
              %li.boolean
                = check_box_tag 'role[user_ids][]', user.id, @role.user_ids.include?(user.id), :id => dom_id(user)
                = label_tag dom_id(user), user.name, :class => "check_box_label"
      - else
        %p No users

  %p
    %button{ :type => 'submit', :class => 'icon check' } Save Changes